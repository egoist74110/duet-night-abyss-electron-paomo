# 如何设置管理员权限

DNA Automator 需要管理员权限才能正常使用以下功能:
- 窗口置顶和切换
- 全局快捷键注册
- 模拟鼠标和键盘操作

## 方法1: 设置exe文件属性 (推荐)

这是最简单的方法,设置一次后每次启动都会自动以管理员身份运行。

### 步骤:
1. 找到 `DNA Automator.exe` 文件
2. **右键点击** exe文件
3. 选择 **"属性"**
4. 切换到 **"兼容性"** 选项卡
5. 勾选 **"以管理员身份运行此程序"**
6. 点击 **"确定"**

### 效果:
- 以后每次双击exe文件都会自动以管理员身份运行
- 不需要每次都右键选择"以管理员身份运行"
- 程序启动时不会弹出权限提示

---

## 方法2: 使用批处理文件

如果你不想修改exe文件属性,可以使用提供的批处理文件。

### 步骤:
1. 找到 `以管理员身份运行.bat` 文件
2. **双击运行** 这个批处理文件
3. 在弹出的UAC对话框中点击 **"是"**

### 效果:
- 批处理文件会自动请求管理员权限
- 然后启动应用程序
- 每次都需要手动运行批处理文件

---

## 方法3: 右键菜单 (临时方案)

如果你只是想临时以管理员身份运行一次。

### 步骤:
1. 找到 `DNA Automator.exe` 文件
2. **右键点击** exe文件
3. 选择 **"以管理员身份运行"**

### 效果:
- 只有这一次会以管理员身份运行
- 下次启动还需要重复这个操作

---

## 如何确认是否有管理员权限?

启动应用后,查看控制台日志(开发模式)或日志文件:

- **有管理员权限**: 显示 `✓ Running with administrator privileges`
- **没有管理员权限**: 显示 `⚠ Application is not running with administrator privileges`

---

## 常见问题

### Q: 为什么需要管理员权限?
A: Windows对窗口操作、全局快捷键、模拟输入等功能有严格的权限控制,需要管理员权限才能正常工作。

### Q: 不以管理员身份运行会怎样?
A: 程序仍然可以启动,但以下功能可能无法正常工作:
- 窗口置顶功能可能失败
- 全局快捷键可能无法注册
- 模拟鼠标和键盘操作可能被阻止

### Q: 设置管理员权限安全吗?
A: 是的,这是正常的Windows权限机制。很多游戏辅助工具、自动化工具都需要管理员权限。

### Q: 我已经设置了管理员权限,为什么还是不工作?
A: 请确保:
1. 你设置的是正确的exe文件
2. 设置后重新启动了应用
3. 查看日志确认是否真的获得了管理员权限

---

## 推荐方案

**对于普通用户**: 使用 **方法1 (设置exe文件属性)**,一次设置,永久有效。

**对于开发者**: 使用 **方法2 (批处理文件)**,方便在开发模式下启动。

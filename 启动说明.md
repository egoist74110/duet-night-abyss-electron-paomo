# DNA Automator 启动说明

## ⚠️ 重要:必须以管理员权限运行

本应用**必须以管理员权限运行**才能正常工作。

### 为什么需要管理员权限?

应用需要管理员权限来执行以下操作:
- ✅ **窗口置顶**: 将游戏窗口置于最前面
- ✅ **全局快捷键**: 注册系统级快捷键(如F1、F2)
- ✅ **鼠标模拟**: 模拟鼠标点击和移动
- ✅ **键盘模拟**: 模拟键盘按键
- ✅ **窗口操作**: 检测和控制其他应用程序的窗口

如果没有管理员权限,这些功能都会失败,显示"拒绝访问"错误。

---

## 🚀 启动方式

### 方式1: 批处理文件启动 (推荐)

**最简单的方式,适合所有用户**

1. 找到项目根目录下的 `以管理员身份运行.bat` 文件
2. 双击运行
3. 在弹出的UAC对话框中点击"是"
4. 应用会自动以管理员权限启动

### 方式2: 命令行启动 (开发者推荐)

**适合开发调试**

1. 右键点击"命令提示符"或"PowerShell"
2. 选择"以管理员身份运行"
3. 切换到项目目录:
   ```bash
   cd D:\你的项目路径\duet-night-abyss-electron-paomo
   ```
4. 运行启动命令:
   ```bash
   npm run dev
   ```

### 方式3: 自动检测启动

**应用内置了自动检测功能**

如果你忘记以管理员身份运行,应用会:
1. 自动检测当前权限
2. 显示友好的对话框说明原因
3. 提供"以管理员身份重启"按钮
4. 一键重启为管理员模式

---

## ✅ 验证管理员权限

启动后,查看控制台输出:

**成功(有管理员权限)**:
```
App is ready, checking admin privileges...
Running with administrator privileges ✓
Creating window...
```

**失败(无管理员权限)**:
```
App is ready, checking admin privileges...
Application is not running with administrator privileges
[弹出对话框提示重启]
```

---

## 🔧 常见问题

### Q: 为什么每次都要以管理员身份运行?
A: 这是Windows的安全机制。游戏辅助类应用需要操作其他程序的窗口和模拟输入,必须有管理员权限。

### Q: 可以不用管理员权限运行吗?
A: 不可以。没有管理员权限,核心功能都无法工作:
- 窗口置顶会失败
- 全局快捷键无法注册
- 鼠标和键盘模拟会被拒绝

### Q: 如何设置永久以管理员身份运行?
A: 
1. 找到 `node.exe` 或应用的可执行文件
2. 右键 → 属性 → 兼容性
3. 勾选"以管理员身份运行此程序"
4. 点击确定

### Q: 启动后还是提示"拒绝访问"?
A: 请检查:
1. 控制台是否显示 `Running with administrator privileges ✓`
2. 如果没有,说明权限检测失败,请手动以管理员身份运行
3. 重启应用

---

## 📝 开发注意事项

如果你是开发者,在开发过程中:

1. **IDE启动**: 如果使用VS Code等IDE的终端,需要以管理员身份启动IDE
2. **调试模式**: 调试时也需要管理员权限
3. **打包发布**: 打包后的exe文件也需要以管理员身份运行

---

## 🎯 快速检查清单

启动前请确认:
- [ ] 以管理员身份打开命令行/双击批处理文件
- [ ] 在UAC对话框中点击"是"
- [ ] 看到 `Running with administrator privileges ✓` 提示
- [ ] 应用正常启动,没有"拒绝访问"错误

如果以上都确认无误,应用就能正常工作了!
